let rooms;window.onload = async function() {    let response = await fetch('home/json', {        method: 'POST',        headers: {            'Content-type': 'application/json'        }    });    if (!response.ok) {        console.log('JSON error');    }    let promise = await response.json();    rooms = promise.rooms;}/* highlights color */$(document).ready(function() {    $('.timetable-sm td').on('mouseover', function() {        $(this).closest('tr').find('th').addClass('highlight');        $(this).closest('table').find('tr:nth-child(2) th:nth-child('+($(this).index()+1)+')').addClass('highlight');    });    $('.timetable-sm td').on('mouseout', function() {        $(this).closest('tr').find('th').removeClass('highlight');        $(this).closest('table').find('tr:nth-child(2) th:nth-child('+($(this).index()+1)+')').removeClass('highlight');    });});/* drag and drop */let timetableContainer = document.getElementById('timetable-container');let item;timetableContainer.ondragstart = event => {    item = event.target;    item.style.opacity = "0.5";};timetableContainer.ondragover = event => {    let td = event.target.closest('td');    if (td) {        event.preventDefault();        td.style.boxShadow = '0 0 15px green';    }};timetableContainer.ondrop = async function(event) {    let td = event.target.closest('td');    if (td) {        event.preventDefault();        let response = await fetch('home/setTime', {            method: 'POST',            body: 'id='+item.id+'&day='+td.id.charAt(0)+'&time='+td.id.charAt(2),            headers: {                'Content-type': 'application/x-www-form-urlencoded'            }        });        if (!response.ok)            console.log('On drop error');        // ez helyett olyan kéne, ahol csak a timetableContainer-rt tölti újra        location.reload();        //target.appendChild(item);    }};timetableContainer.ondragleave = event => {    let td = event.target.closest('td');    if (td) {        td.style.boxShadow = 'none';    }};timetableContainer.ondragend = event => {    item.style.opacity = "1";}/* room select */room_elements = document.getElementsByClassName('room');for (let element of room_elements) {    element.onclick = function() {        if (element.firstChild.tagName !== 'SELECT') {            let select = document.createElement('select');            select.setAttribute('class', 'room-select')            let option = document.createElement('option');            option.setAttribute('value', 'NULL');            select.appendChild(option);            rooms.forEach(room => {                option = document.createElement('option');                option.setAttribute('value', room['id']);                if (room['name'] === element.innerHTML) {                    option.setAttribute('selected', '');                }                option.innerHTML = room['name'];                select.appendChild(option);            });            element.innerHTML = '';            element.appendChild(select);            select.onchange = async function (event) {                let response = await fetch('home/setRoom', {                    method: 'POST',                    body: 'id=' + element.parentElement.id + '&room_id=' + event.target.value,                    headers: {                        'Content-type': 'application/x-www-form-urlencoded'                    }                });                if (!response.ok) {                    console.log('Room on change error');                } else {                    let text = select.options[select.selectedIndex].text                    if (text === '') {                        element.classList.remove('fix');                        element.innerHTML = 'Missing classroom';                    } else {                        element.classList.add('fix');                        element.innerHTML = text;                    }                }            }        }    }}