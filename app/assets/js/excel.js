const characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",INVALID_CHARACTER_ERR=function(){try{document.createElement("$")}catch(e){return e}}();window.btoa||(window.btoa=function(e){let t,n,o,a,r,c,s,l=0,m=e.length,i=Math.max,h="";for(;l<m;){if(i(t=e.charCodeAt(l++)||0,n=e.charCodeAt(l++)||0,s=e.charCodeAt(l++)||0)>255)throw INVALID_CHARACTER_ERR;a=(3&t)<<4|n>>4&15,r=(15&n)<<2|s>>6&3,c=63&s,n?s||(c=64):r=c=64,h+=characters.charAt(o=t>>2&63)+characters.charAt(a)+characters.charAt(r)+characters.charAt(c)}return h});const exportElement=document.getElementById("export");function base64(e){return window.btoa(unescape(encodeURIComponent(e)))}function format(e,t){return e.replace(/{(\w+)}/g,function(e,n){return t[n]})}function getTableContent(){const e=document.getElementsByTagName("table")[0];if(e.classList.contains("timetable"))return e.innerHTML;if(e.classList.contains("timetable-sm"))return e.innerHTML;let t="<tr>"+e.getElementsByTagName("tr")[0].innerHTML+"</tr><tr>";const n=e.getElementsByTagName("td");for(let o=0;o<n.length;o++){t+="<td>",n[o].childNodes.forEach(e=>{"INPUT"===e.tagName&&"hidden"!==e.type?t+=e.value:"SELECT"===e.tagName?t+=e.options[e.selectedIndex].text+" ":"SPAN"!==e.tagName&&"DIV"!==e.tagName||(t+=e.innerHTML)}),t+="</td>",(o+1)%e.rows[0].cells.length==0&&(t+="</tr><tr>")}return t}exportElement&&(exportElement.onclick=function(){const e=document.getElementById("export"),t="data:application/vnd.ms-excel;base64,"+base64(format('<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>{table}</table></body></html>',{worksheet:e.download.substring(e.download.lastIndexOf("-")+1,e.download.lastIndexOf(".")),table:getTableContent()}));e.href=t}());