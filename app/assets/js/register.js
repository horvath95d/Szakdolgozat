let schools,users;window.addEventListener("load",async function(){let e=await fetch("../auth/json",{method:"GET",headers:{"Content-type":"application/json"}});if(!e.ok)return void console.log("JSON error");let t=await e.json();schools=t.schools,users=t.users;const o=document.getElementsByTagName("form")[0];o.addEventListener("submit",function(e){!1===o.checkValidity()&&(e.preventDefault(),e.stopPropagation()),o.classList.add("was-validated")},!1)},!1);const username=document.getElementById("username");username.onkeyup=function(){let e;users.forEach(t=>{t.username===username.value&&(e=!0)}),showError(username,e)};const emial=document.getElementById("email");emial.onkeyup=function(){let e;users.forEach(t=>{t.email===email.value&&(e=!0)}),showError(emial,e)};let fullName=document.getElementById("full_name");fullName.onkeyup=function(){let e;schools.forEach(t=>{t.full_name===fullName.value&&(e=!0)}),showError(fullName,e)};let shortName=document.getElementById("short_name");function showError(e,t){t?e.setCustomValidity("error"):e.setCustomValidity("")}shortName.onkeyup=function(){let e;schools.forEach(t=>{t.short_name===shortName.value&&(e=!0)}),showError(shortName,e)};const password=document.getElementById("password"),confirm_password=document.getElementById("confirm-password");function validatePassword(){password.value===confirm_password.value?confirm_password.setCustomValidity(""):confirm_password.setCustomValidity("error")}password.onchange=validatePassword,confirm_password.onkeyup=validatePassword;const checkbox=document.getElementById("checkbox"),fullNameParent=(fullName=document.getElementById("full_name")).parentElement;shortName=document.getElementById("short_name");const year1=document.getElementById("year1"),year2=document.getElementById("year2"),days=document.getElementById("days"),times=document.getElementById("times"),code_tip=document.getElementById("code-tip");checkbox.onchange=function(){if(fullNameParent.innerHTML="",checkbox.checked){let e=document.createElement("select");e.setAttribute("id","full_name"),e.setAttribute("class","form-control form-control-sm w-75"),e.setAttribute("name","full_name"),e.setAttributeNode(document.createAttribute("required")),schools.forEach(t=>{let o=document.createElement("option");o.setAttribute("value",t.id),o.innerHTML=t.full_name,e.appendChild(o)}),fullNameParent.appendChild(e),shortName.setAttributeNode(document.createAttribute("disabled")),year1.setAttributeNode(document.createAttribute("disabled")),year2.setAttributeNode(document.createAttribute("disabled")),days.setAttributeNode(document.createAttribute("disabled")),times.setAttributeNode(document.createAttribute("disabled")),code_tip.innerHTML="Add meg az iskolához tartozó kódot!"}else{let e=document.createElement("input");e.setAttribute("id","full_name"),e.setAttribute("class","form-control form-control-sm w-75"),e.setAttribute("name","full_name"),e.setAttributeNode(document.createAttribute("required")),fullNameParent.appendChild(e),shortName.removeAttribute("disabled"),year1.removeAttribute("disabled"),year2.removeAttribute("disabled"),days.removeAttribute("disabled"),times.removeAttribute("disabled"),code_tip.innerHTML="Ezt a kódot kell megadni, ha egy új felhasználó csatlakozik az iskola órarendjéhez."}};const eye=document.getElementById("eye"),code=document.getElementById("code");eye&&code&&(eye.onmousedown=function(){eye.innerHTML='<i class="far fa-eye"></i>',code.type="text"},eye.onmouseup=function(){eye.innerHTML='<i class="far fa-eye-slash"></i>',code.type="password"},eye.onmouseout=function(){eye.innerHTML='<i class="far fa-eye-slash"></i>',code.type="password"});