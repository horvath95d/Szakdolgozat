let schools, users;(function() {    window.addEventListener('load', async function() {        let response = await fetch('../auth/json', {            method: 'GET',            headers: {'Content-type': 'application/json'}        });        if (!response.ok) {            console.log('JSON error')            return;        }        let promise = await response.json();        schools = promise.schools;        users = promise.users;        const form = document.getElementsByTagName('form')[0];        form.addEventListener('submit', function(event) {            if (form.checkValidity() === false) {                event.preventDefault();                event.stopPropagation();            }            form.classList.add('was-validated');        }, false);    }, false);})();// username uniqueconst username = document.getElementById('username');username.onkeyup = function() {    let error;    users.forEach(user => {        if (user['username'] === username.value)            error = true;    });    showError(username, error);}// emial uniqueconst emial = document.getElementById('email');emial.onkeyup = function() {    let error;    users.forEach(user => {        if (user['email'] === email.value)            error = true;    });    showError(emial, error)}// school fullName uniquelet fullName = document.getElementById('full_name');fullName.onkeyup = function() {    let error;    schools.forEach(school => {        if (school['full_name'] === fullName.value)            error = true;    });    showError(fullName, error)}// school shortName uniquelet shortName = document.getElementById('short_name');shortName.onkeyup = function() {    let error;    schools.forEach(school => {        if (school['short_name'] === shortName.value)            error = true;    });    showError(shortName, error)}function showError(element, error) {    if (error) {        element.setCustomValidity('error');    }    else {        element.setCustomValidity('');    }}// passwordconst password = document.getElementById('password');const confirm_password = document.getElementById('confirm-password');password.onchange = validatePassword;confirm_password.onkeyup = validatePassword;function validatePassword() {    if (password.value === confirm_password.value) {        confirm_password.setCustomValidity('');    }    else {        confirm_password.setCustomValidity('error');    }}// ---------------// School type// ---------------const checkbox = document.getElementById('checkbox');fullName = document.getElementById('full_name');const fullNameParent = fullName.parentElement;shortName = document.getElementById('short_name');const year1 = document.getElementById('year1');const year2 = document.getElementById('year2');const days = document.getElementById('days');const times = document.getElementById('times');const code_tip = document.getElementById('code-tip');checkbox.onchange = function() {    fullNameParent.innerHTML = '';    if (checkbox.checked) {        let select = document.createElement('select');        select.setAttribute('id', 'full_name');        select.setAttribute('class', 'form-control form-control-sm w-75');        select.setAttribute('name', 'full_name');        select.setAttributeNode(document.createAttribute('required'));        schools.forEach(school => {            let option = document.createElement('option');            option.setAttribute('value', school['id']);            option.innerHTML = school['full_name'];            select.appendChild(option);        });        fullNameParent.appendChild(select);        shortName.setAttributeNode(document.createAttribute('disabled'));        year1.setAttributeNode(document.createAttribute('disabled'));        year2.setAttributeNode(document.createAttribute('disabled'));        days.setAttributeNode(document.createAttribute('disabled'));        times.setAttributeNode(document.createAttribute('disabled'));        code_tip.innerHTML = 'Add meg az iskolához tartozó kódot!';    } else {        let input = document.createElement('input');        input.setAttribute('id', 'full_name');        input.setAttribute('class', 'form-control form-control-sm w-75');        input.setAttribute('name', 'full_name');        input.setAttributeNode(document.createAttribute('required'));        fullNameParent.appendChild(input);        shortName.removeAttribute('disabled');        year1.removeAttribute('disabled');        year2.removeAttribute('disabled');        days.removeAttribute('disabled');        times.removeAttribute('disabled');        code_tip.innerHTML = 'Ezt a kódot kell megadni, ha egy új felhasználó csatlakozik az iskola órarendjéhez.';    }}// ---------------// Show code// ---------------const eye = document.getElementById('eye');const code = document.getElementById('code');if (eye && code) {    eye.onmousedown = function() {        eye.innerHTML = '<i class="far fa-eye"></i>';        code.type = 'text';    }    eye.onmouseup = function() {        eye.innerHTML = '<i class="far fa-eye-slash"></i>';        code.type = 'password';    }    eye.onmouseout = function() {        eye.innerHTML = '<i class="far fa-eye-slash"></i>';        code.type = 'password';    }}