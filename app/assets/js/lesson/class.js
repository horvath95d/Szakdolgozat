const table = document.getElementsByTagName('table')[0];let subjects, teachers, teachers_subjects;window.onload = async function() {    let response = await fetch('../../lesson/json', {        method: 'GET',        headers: {'Content-type': 'application/json'}    });    if (!response.ok) {        console.log('JSON error')        return;    }    let promise = await response.json();    subjects = promise.subjects;    teachers = promise.teachers;    teachers_subjects = promise.teachers_subjects;}document.getElementById('insert').onclick = function() {    let row = table.insertRow(table.rows.length);    let cell0 = row.insertCell(0);        let select = document.createElement('select');        select.setAttribute('name', 'subject_id[]');        select.setAttribute('onchange', 'changeTeacherList(this)');        cell0.appendChild(select);        select.focus();        let option = document.createElement('option');        select.appendChild(option);        subjects.forEach(subject => {            option = document.createElement('option');            option.setAttribute('value', subject['id']);            option.innerHTML = subject['name'];            select.appendChild(option);        });    let cell1 = row.insertCell(1);        select = document.createElement('select');        select.setAttribute('name', 'teacher_id[]');        cell1.appendChild(select);        option = document.createElement('option');        select.appendChild(option);    let cell2 = row.insertCell(2);        let input = document.createElement('input');        input.setAttribute('type', 'number');        input.setAttribute('name', 'count[]');        input.setAttribute('min', '1');        input.setAttribute('value', '1');        cell2.appendChild(input);    row.insertCell(3);    return false;}function changeTeacherList(element) {    const teacherSelect = element.parentElement.nextElementSibling.firstElementChild;    teacherSelect.innerHTML = '';    teachers_subjects.forEach(teacher_subject => {        if (teacher_subject['subject_id'] === element.value) {            teachers.forEach(teacher => {                let option;                if (teacher_subject['teacher_id'] === teacher['id']) {                    option = document.createElement('option');                    option.setAttribute('value', teacher['id']);                    option.innerHTML = teacher['name'];                    teacherSelect.appendChild(option);                }            });        }    });}