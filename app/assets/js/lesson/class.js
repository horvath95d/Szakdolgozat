var table = document.getElementsByTagName('table')[0];var subjects, teachers, teachers_subjects;window.onload = async function() {    let response = await fetch('../../lesson/json', {        method: 'GET',        headers: {            'Content-type': 'application/json'        }    });    if (!response.ok) {        console.log('JSON error')        return;    }        let promis = await response.json();    subjects = promis.subjects;    teachers = promis.teachers;    teachers_subjects = promis.teachers_subjects;}document.getElementById('insert').onclick = function() {    let row = table.insertRow(table.rows.length);        let cell0 = row.insertCell(0);        select = document.createElement('select');        select.setAttribute('name', 'subject_id[]');        select.setAttribute('onchange', 'changeTeacherList(this)');        cell0.appendChild(select);        select.focus();        option = document.createElement('option');        select.appendChild(option);        subjects.forEach(subject => {            option = document.createElement('option');            option.setAttribute('value', subject['id']);            option.innerHTML = subject['name'];            select.appendChild(option);        });    let cell1 = row.insertCell(1);        select = document.createElement('select');        select.setAttribute('name', 'teacher_id[]');        cell1.appendChild(select);        option = document.createElement('option');        select.appendChild(option);    let cell2 = row.insertCell(2);        input = document.createElement('input');        input.setAttribute('type', 'number');        input.setAttribute('name', 'count[]');        input.setAttribute('min', '1');        input.setAttribute('value', '1');        cell2.appendChild(input);    row.insertCell(3);    return false;}function changeTeacherList(element) {    var teacherSelect = element.parentElement.nextElementSibling.firstElementChild;    teacherSelect.innerHTML = '';    teachers_subjects.forEach(teacher_subject => {        if (teacher_subject['subject_id'] == element.value) {                        teachers.forEach(teacher => {                if (teacher_subject['teacher_id'] == teacher['id']) {                    option = document.createElement('option');                    option.setAttribute('value', teacher['id']);                    option.innerHTML = teacher['name'];                    teacherSelect.appendChild(option);                }            });        }    });}function insertSplit() {    var splitTable = document.getElementsByTagName('table')[1];    var select = splitTable.getElementsByTagName('select')[0];    var options = select.getElementsByTagName('option');    var row = splitTable.insertRow(splitTable.rows.length);    for (let i = 0; i < 4; i++) {        var cell = row.insertCell(i);            select = document.createElement('select');            select.setAttribute('name', 'lession'+(i+1)+'[]');            cell.appendChild(select);            if (i === 0) select.focus();                for (let option of options) {                optionElement = document.createElement('option');                optionElement.setAttribute('value', option.value);                optionElement.innerHTML = option.innerHTML;                select.appendChild(optionElement);            }    }}